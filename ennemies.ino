
const uint16_t ennemyRunData[] = {11,10,3, 3, 0xffff, 0, 0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x4a86,0x6328,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5ac8,0x5285,0x7326,0x7326,0xffff,0x94b1,0x94b1,0xffff,0xffff,0xffff,0x4a65,0x4a66,0x72a5,0xc4c9,0x9491,0x5288,0x5288,0xffff,0xffff,0xffff,0x62e6,0x52e7,0x3a25,0x2963,0x2902,0x5225,0x5288,0xffff,0xffff,0xffff,0xffff,0xffff,0x4266,0x4245,0x2922,0x3983,0x6243,0xc4c9,0xffff,0xffff,0xffff,0xffff,0x39c3,0x31a3,0x6ac5,0x8366,0x4266,0xffff,0x8c70,0xffff,0xffff,0x41a3,0x4aa6,0x4266,0x5ae8,0x2963,0x4266,0x4266,0xffff,0xffff,0xffff,0xffff,0x6224,0xffff,0xffff,0xffff,0xffff,0x39c4,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x6203,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x4245,0x5b27,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5ae9,0x5a85,0x7b26,0x7326,0xffff,0x94b1,0x94b1,0xffff,0xffff,0xffff,0x5244,0x5307,0x5244,0xc4c9,0x9491,0x5288,0x5288,0xffff,0xffff,0xffff,0x7306,0x52c6,0x4225,0x39e4,0x2101,0x5225,0x5288,0xffff,0xffff,0xffff,0xffff,0xffff,0x4a44,0x4a86,0x2942,0x31a5,0x6243,0xc4c9,0xffff,0xffff,0xffff,0xffff,0xffff,0x2962,0x7306,0x8b87,0xffff,0xffff,0x8c70,0xffff,0xffff,0xffff,0xffff,0x6203,0x2942,0x52c7,0x52a8,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0xffff,0x4a45,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x5a24,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5b27,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x52c6,0x6b8a,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x842f,0x39c3,0xc4c9,0x83ab,0xffff,0x94b1,0x94b1,0xffff,0xffff,0xffff,0x5244,0x5b48,0x4a45,0x7b07,0xffff,0x5288,0x5288,0xffff,0xffff,0xffff,0xffff,0x5aa5,0x4265,0x3a25,0x2102,0x2102,0x5288,0xffff,0xffff,0xffff,0xffff,0xffff,0x39c2,0x5b28,0x5265,0x39a4,0x9491,0xc4c9,0xffff,0xffff,0xffff,0xffff,0xffff,0x2962,0x2962,0x9bc7,0xa4f1,0xffff,0xffff,0xad74,0xffff,0xffff,0xffff,0xffff,0x52c7,0x31a3,0x39c4,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x6329,0x2942,0x6203,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5225,0x6244,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff};
Image ennemyRun = Image(ennemyRunData);

const uint16_t ennemyFireData[] = {13,10,3, 3, 0xffff, 0, 0xffff,0xffff,0xffff,0x5b27,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x52c6,0x6b8a,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x39a3,0x8b46,0xc4c9,0x83ab,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x7bab,0x5ac6,0x49c2,0x7b07,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0x52a6,0x4266,0x2963,0x2963,0x3163,0x2102,0x39a3,0x4a68,0x840f,0xf720,0xffff,0xffff,0xffff,0x4a67,0x62e6,0x6285,0x2102,0x3142,0xc4c9,0xffff,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0xffff,0x3162,0x4a04,0x4245,0x8c4f,0x6265,0xffde,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x4aa6,0x634a,0x39c4,0x4266,0x738c,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5aa8,0x4a46,0xffff,0x7bcd,0x5266,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x6203,0xffff,0xffff,0xffff,0x51a2,0x6203,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5b27,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffdf,0x6203,0x52c6,0x6b8a,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x39a3,0x8b46,0xc4c9,0x83ab,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x7bab,0x5ac6,0x49c2,0x7b07,0xffff,0xffff,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0xffff,0x52a6,0x4266,0x2963,0x2963,0x3163,0x2102,0x39a3,0x4a68,0x840f,0xffff,0xf720,0xffff,0xffff,0x4a67,0x62e6,0x6285,0x2102,0x3142,0xc4c9,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0xffff,0xffff,0x3162,0x4a04,0x4245,0x8c4f,0x6265,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x4aa6,0x634a,0x39c4,0x4266,0x738c,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5aa8,0x4a46,0xffff,0x7bcd,0x5266,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x6203,0xffff,0xffff,0xffff,0x51a2,0x6203,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5b27,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x52c6,0x6b8a,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x39a3,0x8b46,0xc4c9,0x83ab,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x7bab,0x5ac6,0x49c2,0x7b07,0xffff,0xffff,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0xffff,0x52a6,0x4266,0x2963,0x2963,0x3163,0x2102,0x39a3,0x4a68,0x840f,0xffff,0xffff,0xf720,0xffff,0x4a67,0x62e6,0x6285,0x2102,0x3142,0xc4c9,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0xffff,0xffff,0x3162,0x4a04,0x4245,0x8c4f,0x6265,0xffde,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x4aa6,0x634a,0x39c4,0x4266,0x738c,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5aa8,0x4a46,0xffff,0x7bcd,0x5266,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x6203,0xffff,0xffff,0xffff,0x51a2,0x6203,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff};
Image ennemyFire = Image(ennemyFireData);

const uint16_t ennemyIdlData[] = {10,10,1, 1, 0xffff, 0, 0xffff,0xffff,0xffff,0x5b27,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x6203,0x52c6,0x6b8a,0x6b8a,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x39a3,0x8b46,0xc4c9,0x83ab,0xffff,0xffff,0xffff,0xffff,0xffff,0x7bab,0x5ac6,0x49c2,0x7b07,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x52a6,0x4266,0x2963,0x2963,0x3163,0x2102,0x39a3,0x4a68,0x840f,0xffff,0x4a67,0x62e6,0x6285,0x2102,0x3142,0xc4c9,0xffff,0xffff,0xffff,0xffff,0xffff,0x3162,0x4a04,0x4245,0x8c4f,0x6265,0xffff,0xffff,0xffff,0xffff,0xffff,0x4aa6,0x634a,0x39c4,0x4266,0x738c,0xffff,0xffff,0xffff,0xffff,0x5aa8,0x4a46,0xffff,0x7bcd,0x5266,0xffff,0xffff,0xffff,0xffff,0x6203,0x6203,0xffff,0xffff,0xffff,0x51a2,0x6203,0xffff,0xffff,0xffff};
Image ennemyIdl = Image(ennemyIdlData);

boolean collideEnnemyAndBullets(Ennemies ennemy) 
{
  for(int i = 0 ; i< NB_PLAYER_BULLET; ++i){
    if(soldatBullet[i].life>0) {
      if(Collision(soldatBullet[i].x, soldatBullet[i].y, 2, 2, ennemy.x, ennemy.y, ENNEMIE_W, ENNEMIE_H)) {
        soldatBullet[i].life = 0;
        return true;
      }
    }
  }
  return false;
}

void initEnnemies()
{
   //init state
  for(int i = 0 ; i< NB_MAX_ENNEMIES; ++i) {
    ennemies[i].life = 1;
    ennemies[i].x = gb.display.width() + random(0,10); //first time we add ennemei randomly
    ennemies[i].y = random(0,gb.display.height());
    
    ennemies[i].fire = NB_FRAME_FIRE_ANIM;
    ennemies[i].isRun = false;
  }
}

void updateEnnemies()
{
  for(int i = 0 ; i< NB_MAX_ENNEMIES; ++i) {
   if(ennemies[i].life>0) {
    if(collideEnnemyAndBullets(ennemies[i])) {
      --ennemies[i].life; //we die
    }
    
    if (ennemies[i].fire>0) {
      --ennemies[i].fire;
    } else {
    //la method attend un pointeur sur ennemy nous envoyons donc le pointeur et non l objet directement
      actionEnnemy(&ennemies[i]);
    }
   }
  }
}

void drawEnnemies()
{
  gb.display.setColor(RED);
  for(int i = 0 ; i< NB_MAX_ENNEMIES; ++i) {
   if(ennemies[i].life>0) {
    if(ennemies[i].fire>0) {
      gb.display.drawImage( ennemies[i].x  , ennemies[i].y , ennemyFire, -13,10);
    } else if(ennemies[i].isRun == true){
      gb.display.drawImage( ennemies[i].x  , ennemies[i].y , ennemyRun,-11,10);
    } else {
      gb.display.drawImage( ennemies[i].x  , ennemies[i].y , ennemyIdl,-10,10);
    }
   }
  }
}


void actionEnnemy(Ennemies *ennemy)//nous utilison un pointer sur l objet afin de pouvoir modifier ses valeurs dans une fonction séparé
{
  
   int nextAction = random(0,100);

   if(nextAction < 1) {
    //fire 
    ennemy->fire = NB_FRAME_FIRE_ANIM;
    createNewEnnemyBullet(*ennemy); //send value in this method
   } else if(nextAction < 10) {
    --ennemy->x; //on avance
    ennemy->isRun = true;
   }
    
}

