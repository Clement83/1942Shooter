#define SOLDAT_X 3
#define SOLDAT_START_LIFE 100

const uint16_t soldatFireData[] = {12,7,2, NB_FRAME_FIRE_ANIM, 0xffff, 0, 0xffff,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0xffff,0x0,0xffff,0xf720,0xffff,0xffff,0xffff,0x0,0xcc68,0xffff,0x0,0x0,0x0,0x0,0xf720,0xffff,0xffff,0xffff,0xffff,0x5268,0x5268,0x0,0x0,0x0,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0x5268,0x5268,0x5268,0xffff,0x5268,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5268,0x5268,0x5268,0x5268,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0xffff,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0x0,0xffde,0x0,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0x0,0xffff,0xf720,0xffff,0xffff,0xffff,0xffff,0x0,0xcc68,0x0,0x0,0x0,0x0,0xffff,0xffff,0xf720,0xf720,0xffff,0xffff,0x5268,0x0,0x0,0x0,0xffff,0xffff,0xffff,0xf720,0xffff,0xffff,0xffff,0x5268,0x5268,0x5268,0xffff,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x5268,0x5268,0x5268,0x5268,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0xffff,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0x0,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff};
Image soldatFire = Image(soldatFireData);

const uint16_t soldatRunData[] = {8,7,2, 3, 0xffff, 0, 0xffff,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0xcc68,0xffff,0xffff,0xffff,0x0,0xffff,0x8c4d,0x5268,0x5268,0x0,0x0,0x0,0x0,0xffff,0x5268,0x5268,0x0,0x0,0x0,0xffff,0xffff,0xffff,0x5268,0x5268,0x5268,0x5268,0x0,0xffdf,0xfffe,0xffff,0x0,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0xcc68,0xffff,0xffff,0xffff,0x0,0xffff,0xffff,0x5268,0x5268,0x0,0x0,0x0,0x0,0xffff,0x5268,0x5268,0x0,0x0,0x0,0xffff,0xffff,0xffff,0x5268,0x5268,0x5268,0x5268,0x0,0xffdf,0xffff,0x0,0x0,0xffff,0xffff,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0x0,0xffff,0xffff,0xffff};
Image soldatRun = Image(soldatRunData);

const uint16_t soldatIdlData[] = {8,7,1, 0, 0xffff, 0, 0xffff,0xffff,0x0,0x0,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0x0,0xcc68,0xffff,0xffff,0xffff,0x0,0xffff,0x5268,0x5268,0x5268,0x0,0x0,0x0,0x0,0xffff,0x5268,0x5268,0x0,0x0,0x0,0xffff,0xffff,0xffff,0x5268,0x5268,0x5268,0x5268,0x0,0xffdf,0xfffe,0xffff,0x0,0xffff,0xffff,0x0,0xffff,0xffff,0xffff,0x0,0x0,0xffff,0x0,0x0,0xffff,0xffff,0xffff};
Image soldatIdl = Image(soldatIdlData);

boolean collidePlayerAndBullets() 
{
  for(int i = 0 ; i< NB_ENNEMY_BULLET; ++i){
    if(ennemyBullet[i].life>0) {
      if(Collision(ennemyBullet[i].x, ennemyBullet[i].y, 2, 2, SOLDAT_X, soldat.y, 5, 5)) {
        soldatBullet[i].life = 0;
        return true;
      }
    }
  }
  return false;
}

void initPlayer()
{
  soldat.y = 40;
  soldat.life = SOLDAT_START_LIFE;
  soldat.fire = 0;
  soldat.isRun = false;
}

void updatePlayer()
{  
  soldat.isRun = false;
  if (gb.buttons.repeat(BUTTON_UP,0)) {
    soldat.y--;
    soldat.isRun = true;
  }
  
  if (gb.buttons.repeat(BUTTON_DOWN,0)) {
    soldat.y++;
    soldat.isRun = true;
  }
   
  if (soldat.fire>0) {
    --soldat.fire;
  }
  if (soldat.fire == 0 && gb.buttons.pressed(BUTTON_A)) {
    soldat.fire = NB_FRAME_FIRE_ANIM;
  }
}

void drawPlayer()
{ 
  if(soldat.fire == NB_FRAME_FIRE_ANIM) {
    gb.lights.fill(YELLOW);
  } 
  if(soldat.fire>0) {
    gb.display.drawImage( SOLDAT_X , soldat.y , soldatFire);
  } else if(soldat.isRun == true){
    gb.display.drawImage( SOLDAT_X , soldat.y , soldatRun);
  } else {
    gb.display.drawImage( SOLDAT_X , soldat.y , soldatIdl);
  }
}
